import{_ as ce}from"../geotiff/geotiff.41c905a7.js";import{f as p,_ as ge,ah as d,ar as B,O as f,P as o,u as b,H as fe,o as r,a as V,V as l,a9 as _e,c as D,a8 as U,F as Q,Q as E,T as v,U as ye,S as ve,n as M}from"../@vue/@vue.e2fe22e8.js";import{h as N,_ as he}from"../../assets/index-dad82031.js";import{p as be}from"../index/index.4cea0243.js";import{M as Ve,R as ke,S as we}from"../@element-plus/@element-plus.5b94a560.js";import{L as xe}from"../index/index.5f03d345.js";import{a as Ce}from"../axios/axios.4a70c6fc.js";import{b as R}from"../element-plus/element-plus.d7de122a.js";import"../pinia/pinia.261327f3.js";import"../js-cookie/js-cookie.edb2da2a.js";import"../vue-router/vue-router.62ea77a8.js";import"../path-to-regexp/path-to-regexp.6c7b4327.js";import"../fuse.js/fuse.js.88e2763d.js";import"../path-browserify/path-browserify.cb69e156.js";import"../clipboard/clipboard.45ef5b9b.js";import"../screenfull/screenfull.b3e6dc1f.js";import"../vue-i18n/vue-i18n.90b8095f.js";import"../@intlify/@intlify.771bffe6.js";import"../mitt/mitt.f7ef348c.js";import"../lodash-es/lodash-es.facb48df.js";import"../@vueuse/@vueuse.bcdec864.js";import"../nprogress/nprogress.6ec30c0f.js";/* empty css                                 */import"../xe-utils/xe-utils.78945774.js";import"../vxe-table/vxe-table.e2a848aa.js";import"../vue3-lottie/vue3-lottie.dd2d606e.js";import"../lottie-web/lottie-web.88e5cf38.js";import"../@popperjs/@popperjs.c75af06c.js";import"../@ctrl/@ctrl.f8748455.js";import"../dayjs/dayjs.b8791c9c.js";import"../async-validator/async-validator.dee29e8b.js";import"../memoize-one/memoize-one.297ddbcb.js";import"../escape-html/escape-html.bccd5692.js";import"../normalize-wheel-es/normalize-wheel-es.ed76fb12.js";import"../@floating-ui/@floating-ui.682dc3ac.js";function Se(s){return N.request({url:"/article/create",method:"post",data:s})}function De(s){return N.request({url:"/article/update",method:"post",data:s})}const Ue="http://10.10.11.65:8095/",j=Ce.create({baseURL:Ue});j.interceptors.response.use(s=>s,s=>(console.error("API Error:",s),Promise.reject(s)));const Qe="/api/work-order",Pe=(s=1,u=10,w="createdAt",x="DESC")=>j.get(`${Qe}`,{params:{page:s,size:u,sortField:w,direction:x}});function Ae(s){const u=new Date(s),w=u.getFullYear(),x=String(u.getMonth()+1).padStart(2,"0"),c=String(u.getDate()).padStart(2,"0"),P=String(u.getHours()).padStart(2,"0"),m=String(u.getMinutes()).padStart(2,"0"),C=String(u.getSeconds()).padStart(2,"0");return`${w}-${x}-${c} ${P}:${m}:${C}`}const Te={class:"app-container"},ze={class:"filter-container"},Fe={class:"filter-left"},Ie={class:"filter-right"},Le={class:"dialog-footer"},Ee={class:"dialog-footer"},Re=fe({name:"ComplexTable"}),$e=Object.assign(Re,{setup(s){const u=p([{key:"CN",display_name:"China"},{key:"US",display_name:"USA"},{key:"JP",display_name:"Japan"},{key:"EU",display_name:"Eurozone"}]),w=i=>{t.listQuery.limit=i,T()},x=i=>{t.listQuery.page=i,T()},c=p(null),P=p(0),m=p(null),C=p(!0),H=p([1,2,3]),J=p([{label:"ID 升序",key:"+id"},{label:"ID 降序",key:"-id"}]),K=p(["published","draft","deleted"]),S=p(!1),A=p(""),z=p(!1),W=p([]),F=p(!1),t=ge({listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"-id"},temp:{id:void 0,importance:1,remark:"",timestamp:new Date,title:"",type:"",status:"published",author:"vite element admin"},textMap:{update:"Edit",create:"Create"},rules:{type:[{required:!0,message:"type is required",trigger:"change"}],timestamp:[{type:"date",required:!0,message:"timestamp is required",trigger:"change"}],title:[{required:!0,message:"title is required",trigger:"blur"}]}}),I=()=>{S.value=!1},Y=()=>{z.value=!1},T=async()=>{C.value=!0,m.value=null;try{const i=await Pe(t.listQuery.page,t.listQuery.limit);console.log("API Response:",i.data);const a=i.data.data.content;P.value=i.data.data.totalElements,console.log(a),m.value=a,console.log("Updated List:",m.value)}catch(i){console.error("Failed to fetch data:",i)}finally{C.value=!1}},L=()=>{t.listQuery.page=1,T()},G=()=>{t.temp={id:0,importance:1,remark:"",timestamp:new Date,title:"",status:"published",type:"",author:"vite element admin"}},X=()=>{G(),A.value="create",S.value=!0,M(()=>{c.value&&c.value.clearValidate()})},Z=()=>{c.value&&c.value.validate(i=>{i&&(t.temp.id=parseInt(Math.random()*100)+1024,t.temp.author="vite element admin",Se(b(t.temp)).then(()=>{m.value.unshift(b(t.temp)),I(),R({title:"Success",message:"Created Successfully",type:"success",duration:2e3})}))})},ee=i=>{t.temp=Object.assign({},i),t.temp.timestamp=new Date(t.temp.timestamp),A.value="update",S.value=!0,M(()=>{c.value&&c.value.clearValidate()})},te=()=>{var i;(i=c.value)==null||i.validate(a=>{if(a){const g={...t.temp};De(g).then(()=>{const _=m.value.findIndex(h=>h.id===t.temp.id);m.value.splice(_,1,t.temp),I(),R({title:"Success",message:"Update Successfully",type:"success",duration:2e3})})}})},le=(i,a)=>{R({title:"Success",message:"Delete Successfully",type:"success",duration:2e3}),m.value.splice(a,1)},ae=()=>{F.value=!0,ce(()=>import("../vendor/Export2Excel.addf964a.js"),["..\\vendor\\Export2Excel.addf964a.js","..\\file-saver\\file-saver.d560e744.js","..\\clipboard\\clipboard.45ef5b9b.js","..\\xlsx\\xlsx.7367b54f.js"],import.meta.url).then(i=>{const a=["timestamp","title","type","importance","status"],_=oe(["timestamp","title","type","importance","status"]);i.export_json_to_excel({header:a,data:_,filename:"table-list"}),F.value=!1})},oe=i=>m.value.map(a=>i.map(g=>g==="timestamp"?be(a[g]):a[g]));return T(),(i,a)=>{const g=d("el-input"),_=d("el-option"),h=d("el-select"),y=d("el-button"),n=d("el-table-column"),ie=d("el-image"),$=d("el-table"),ne=d("el-pagination"),k=d("el-form-item"),re=d("el-date-picker"),se=d("el-rate"),pe=d("el-form"),O=d("el-dialog"),q=B("wave"),de=B("loading");return r(),f(b(xe),{title:"维护工单管理"},{body:o(()=>[V("div",Te,[V("div",ze,[V("div",Fe,[l(g,{modelValue:t.listQuery.title,"onUpdate:modelValue":a[0]||(a[0]=e=>t.listQuery.title=e),placeholder:"工单名称",style:{width:"120px","margin-right":"20px"},class:"filter-item",onKeyup:_e(L,["enter"])},null,8,["modelValue","onKeyup"]),l(h,{modelValue:t.listQuery.importance,"onUpdate:modelValue":a[1]||(a[1]=e=>t.listQuery.importance=e),placeholder:"维护类型",clearable:"",style:{width:"120px","margin-right":"20px"},class:"filter-item"},{default:o(()=>[(r(!0),D(Q,null,U(H.value,e=>(r(),f(_,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(h,{modelValue:t.listQuery.type,"onUpdate:modelValue":a[2]||(a[2]=e=>t.listQuery.type=e),placeholder:"优先级",clearable:"",class:"filter-item",style:{width:"130px","margin-right":"20px"}},{default:o(()=>[(r(!0),D(Q,null,U(u.value,e=>(r(),f(_,{key:e.key,label:e.display_name+"("+e.key+")",value:e.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(h,{modelValue:t.listQuery.sort,"onUpdate:modelValue":a[3]||(a[3]=e=>t.listQuery.sort=e),style:{width:"140px","margin-right":"20px"},class:"filter-item",onChange:L},{default:o(()=>[(r(!0),D(Q,null,U(J.value,e=>(r(),f(_,{key:e.key,label:e.label,value:e.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),E((r(),f(y,{class:"filter-item",type:"default",icon:b(Ve),onClick:L},{default:o(()=>[v(" 搜索 ")]),_:1},8,["icon"])),[[q]])]),V("div",Ie,[l(y,{class:"filter-item",type:"primary",icon:b(ke),onClick:X},{default:o(()=>[v(" 新增 ")]),_:1},8,["icon"]),E((r(),f(y,{loading:F.value,class:"filter-item",type:"success",icon:b(we),onClick:ae},{default:o(()=>[v(" 导出 ")]),_:1},8,["loading","icon"])),[[q]])])]),E((r(),f($,{data:m.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"},"row-key":"ID","tree-props":{children:"children"},"default-expand-all":""},{default:o(()=>[l(n,{label:"ID",prop:"id",align:"center",width:"120"}),l(n,{label:"工单名称",prop:"name",align:"center",width:"200"}),l(n,{label:"截止日期",prop:"due_date",align:"center",width:"180"},{default:o(({row:e})=>[V("span",null,ye(b(Ae)(e.due_date)),1)]),_:1}),l(n,{label:"工单号",prop:"code",align:"center",width:"220"}),l(n,{label:"工单预览图",align:"center",width:"150"},{default:o(({row:e})=>[l(ie,{style:{width:"80px",height:"80px"},src:e.image_path[0],loading:"lazy","preview-src-list":[e.image_path[0]]},null,8,["src","preview-src-list"])]),_:1}),l(n,{label:"进度",prop:"进度",align:"center",width:"100"}),l(n,{label:"优先级",prop:"priority.name",align:"center",width:"100"}),l(n,{label:"维护类型",prop:"维护类型",align:"center",width:"150"}),l(n,{label:"类别",prop:"类别",align:"center",width:"150"}),l(n,{label:"派发人",prop:"派发人",align:"center",width:"150"}),l(n,{label:"创建者",prop:"创建者",align:"center",width:"150"}),l(n,{label:"预估时间",prop:"预估时间",align:"center",width:"150"}),l(n,{label:"Actions",align:"center",width:"250","class-name":"small-padding fixed-width action-column",fixed:"right"},{default:o(({row:e,$index:ue})=>[l(y,{type:"info",size:"small"},{default:o(()=>[v(" 查看 ")]),_:1}),l(y,{type:"primary",size:"small",onClick:me=>ee(e)},{default:o(()=>[v(" 修改 ")]),_:2},1032,["onClick"]),e.status!="deleted"?(r(),f(y,{key:0,size:"small",type:"danger",onClick:me=>le(e,ue)},{default:o(()=>[v(" 删除 ")]),_:2},1032,["onClick"])):ve("",!0)]),_:1})]),_:1},8,["data"])),[[de,C.value]]),l(ne,{class:"pagination-center",total:P.value,"hide-on-single-page":!0,currentPage:t.listQuery.page,"onUpdate:currentPage":a[4]||(a[4]=e=>t.listQuery.page=e),"page-size":t.listQuery.limit,"onUpdate:pageSize":a[5]||(a[5]=e=>t.listQuery.limit=e),layout:"total, sizes, prev, pager, next, jumper",onSizeChange:w,onCurrentChange:x},null,8,["total","currentPage","page-size"]),l(O,{title:t.textMap[A.value],modelValue:S.value,"onUpdate:modelValue":a[13]||(a[13]=e=>S.value=e)},{footer:o(()=>[V("div",Le,[l(y,{onClick:I},{default:o(()=>[v(" Cancel ")]),_:1}),l(y,{type:"primary",onClick:a[12]||(a[12]=e=>A.value==="create"?Z():te())},{default:o(()=>[v(" Confirm ")]),_:1})])]),default:o(()=>[l(pe,{ref_key:"dataForm",ref:c,rules:t.rules,model:t.temp,"label-position":"left","label-width":"70px",style:{width:"400px","margin-left":"50px"}},{default:o(()=>[l(k,{label:"Type",prop:"type"},{default:o(()=>[l(h,{modelValue:t.temp.type,"onUpdate:modelValue":a[6]||(a[6]=e=>t.temp.type=e),class:"filter-item",placeholder:"Please select"},{default:o(()=>[(r(!0),D(Q,null,U(u.value,e=>(r(),f(_,{key:e.key,label:e.display_name,value:e.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(k,{label:"Date",prop:"timestamp"},{default:o(()=>[l(re,{modelValue:t.temp.timestamp,"onUpdate:modelValue":a[7]||(a[7]=e=>t.temp.timestamp=e),type:"datetime",placeholder:"Please pick a date"},null,8,["modelValue"])]),_:1}),l(k,{label:"Title",prop:"title"},{default:o(()=>[l(g,{modelValue:t.temp.title,"onUpdate:modelValue":a[8]||(a[8]=e=>t.temp.title=e)},null,8,["modelValue"])]),_:1}),l(k,{label:"Status"},{default:o(()=>[l(h,{modelValue:t.temp.status,"onUpdate:modelValue":a[9]||(a[9]=e=>t.temp.status=e),class:"filter-item",placeholder:"Please select"},{default:o(()=>[(r(!0),D(Q,null,U(K.value,e=>(r(),f(_,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(k,{label:"Imp"},{default:o(()=>[l(se,{modelValue:t.temp.importance,"onUpdate:modelValue":a[10]||(a[10]=e=>t.temp.importance=e),colors:["#99A9BF","#F7BA2A","#FF9900"],max:3,style:{"margin-top":"8px"}},null,8,["modelValue"])]),_:1}),l(k,{label:"Remark"},{default:o(()=>[l(g,{modelValue:t.temp.remark,"onUpdate:modelValue":a[11]||(a[11]=e=>t.temp.remark=e),autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"Please input"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"]),l(O,{modelValue:z.value,"onUpdate:modelValue":a[14]||(a[14]=e=>z.value=e),title:"Reading statistics"},{footer:o(()=>[V("span",Ee,[l(y,{type:"primary",onClick:Y},{default:o(()=>[v("Confirm")]),_:1})])]),default:o(()=>[l($,{data:W.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"}},{default:o(()=>[l(n,{prop:"key",label:"Channel"}),l(n,{prop:"pv",label:"Pv"})]),_:1},8,["data"])]),_:1},8,["modelValue"])])]),_:1})}}}),Vt=he($e,[["__scopeId","data-v-6d3e9038"]]);export{Vt as default};
